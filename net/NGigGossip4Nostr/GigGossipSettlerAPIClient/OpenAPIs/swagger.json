{
  "openapi": "3.0.1",
  "info": {
    "title": "GigGossipSettlerAPI",
    "version": "1.0"
  },
  "paths": {
    "/getcapublickey": {
      "get": {
        "tags": [
          "GigGossipSettlerAPI"
        ],
        "summary": "Public key of this Certification Authority.",
        "description": "Public key of this Certification Authority that can be used to validate signatures of e.g. issued certificates.",
        "operationId": "GetCaPublicKey",
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "/iscertificaterevoked": {
      "get": {
        "tags": [
          "GigGossipSettlerAPI"
        ],
        "summary": "Is the certificate revoked by this Certification Authority.",
        "description": "Returns true if the certificate has been revoked, false otherwise. Usefull to implement revocation list.",
        "operationId": "IsCertificateRevoked",
        "parameters": [
          {
            "name": "certid",
            "in": "query",
            "description": "Serial number of the certificate.",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "boolean"
                }
              }
            }
          }
        }
      }
    },
    "/gettoken": {
      "get": {
        "tags": [
          "GigGossipSettlerAPI"
        ],
        "summary": "Creates authorisation token guid",
        "description": "Creates a new token Guid that is used for further communication with the API",
        "operationId": "GetToken",
        "parameters": [
          {
            "name": "pubkey",
            "in": "query",
            "description": "public key identifies the API user",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          }
        }
      }
    },
    "/giveuserproperty": {
      "get": {
        "tags": [
          "GigGossipSettlerAPI"
        ],
        "summary": "Grants a property to the subject.",
        "description": "Grants a property to the subject (e.g. driving licence). Only authorised users can grant the property.",
        "operationId": "GiveUserProperty",
        "parameters": [
          {
            "name": "authToken",
            "in": "query",
            "description": "Authorisation token for the communication. This is a restricted call and authToken needs to be the token of the authorised user excluding the Subject.",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "pubkey",
            "in": "query",
            "description": "Public key of the subject.",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "name",
            "in": "query",
            "description": "Name of the property.",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "value",
            "in": "query",
            "description": "Value of the property.",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "validTill",
            "in": "query",
            "description": "Date and time after which the property will not be valid anymore",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/verifychannel": {
      "get": {
        "tags": [
          "GigGossipSettlerAPI"
        ],
        "summary": "Start verification of specific channel.",
        "description": "Starts verification of specific channel.",
        "operationId": "VerifyChannel",
        "parameters": [
          {
            "name": "authToken",
            "in": "query",
            "description": "Authorisation token for the communication. This is a restricted call and authToken needs to be the token of the authorised user excluding the Subject.",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "pubkey",
            "in": "query",
            "description": "Public key of the subject.",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "name",
            "in": "query",
            "description": "Channel name (phone,email,...)",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "method",
            "in": "query",
            "description": "Method (sms,call,message)",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "value",
            "in": "query",
            "description": "Value of Channel for the method (phone number, email address).",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/submitchannelsecret": {
      "get": {
        "tags": [
          "GigGossipSettlerAPI"
        ],
        "summary": "Submits the secret code for the channel.",
        "description": "Returns 0 if the secret is correct, otherwise the number of retires left is returned.",
        "operationId": "SubmitChannelSecret",
        "parameters": [
          {
            "name": "authToken",
            "in": "query",
            "description": "Authorisation token for the communication. This is a restricted call and authToken needs to be the token of the authorised user excluding the Subject.",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "pubkey",
            "in": "query",
            "description": "Public key of the subject.",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "name",
            "in": "query",
            "description": "Channel name (phone,email,...)",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "method",
            "in": "query",
            "description": "Method (sms,call,message)",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "value",
            "in": "query",
            "description": "Value of Channel for the method (phone number, email address).",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "secret",
            "in": "query",
            "description": "Secret received from the channel.",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "integer",
                  "format": "int32"
                }
              }
            }
          }
        }
      }
    },
    "/revokeuserproperty": {
      "get": {
        "tags": [
          "GigGossipSettlerAPI"
        ],
        "description": "Revokes a property from the subject (e.g. driving licence is taken by the police). Only authorised users can revoke the property.",
        "parameters": [
          {
            "name": "authToken",
            "in": "query",
            "description": "Authorisation token for the communication. This is a restricted call and authToken needs to be the token of the authorised user excluding the Subject.",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "pubkey",
            "in": "query",
            "description": "Public key of the subject.",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "name",
            "in": "query",
            "description": "Name of the property.",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/issuecertificate": {
      "get": {
        "tags": [
          "GigGossipSettlerAPI"
        ],
        "summary": "Issues a new Digital Certificate for the Subject.",
        "description": "Issues a new Digital Certificate for the Subject. Only authorised users can issue the certificate.",
        "operationId": "IssueCertificate",
        "parameters": [
          {
            "name": "authToken",
            "in": "query",
            "description": "Authorisation token for the communication. This is a restricted call and authToken needs to be the token of the authorised user including Subject.",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "pubkey",
            "in": "query",
            "description": "Public key of the Subject.",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "properties",
            "in": "query",
            "description": "List of properties for the certificate",
            "required": true,
            "style": "form",
            "schema": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "format": "byte"
                }
              }
            }
          }
        }
      }
    },
    "/getcertificate": {
      "get": {
        "tags": [
          "GigGossipSettlerAPI"
        ],
        "summary": "Returns an existing Digital Certificate for the Subject.",
        "description": "Returns an existing Digital Certificate for the Subject. Only authorised users can get the certificate.",
        "operationId": "GetCertificate",
        "parameters": [
          {
            "name": "authToken",
            "in": "query",
            "description": "Authorisation token for the communication. This is a restricted call and authToken needs to be the token of the authorised user including Subject.",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "pubkey",
            "in": "query",
            "description": "Public key of the Subject.",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "certid",
            "in": "query",
            "description": "Serial number of the certificate.",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "format": "byte"
                }
              }
            }
          }
        }
      }
    },
    "/listcertificates": {
      "get": {
        "tags": [
          "GigGossipSettlerAPI"
        ],
        "summary": "Lists serial numbers of all Digital Certificate issued for the Subject.",
        "description": "Lists serial numbers of all Digital Certificate issued for the Subject. Only authorised users can list certificates.",
        "operationId": "ListCertificates",
        "parameters": [
          {
            "name": "authToken",
            "in": "query",
            "description": "Authorisation token for the communication. This is a restricted call and authToken needs to be the token of the authorised user including Subject.",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "pubkey",
            "in": "query",
            "description": "Public key of the Subject.",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "format": "uuid"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/generatereplypaymentpreimage": {
      "get": {
        "tags": [
          "GigGossipSettlerAPI"
        ],
        "summary": "Generates new reply payment preimage and returns its hash.",
        "description": "Generates new reply payment preimage for the lightning network HODL invoice. This preimage is secret as long as the gig-job referenced by gigId is not marked as settled. The method returns hash of this preimage.",
        "operationId": "GenerateReplyPaymentPreimage",
        "parameters": [
          {
            "name": "authToken",
            "in": "query",
            "description": "Authorisation token for the communication.",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "gigId",
            "in": "query",
            "description": "gig-job identifier",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "repliperPubKey",
            "in": "query",
            "description": "Public key of the replier.",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "/generaterelatedpreimage": {
      "get": {
        "tags": [
          "GigGossipSettlerAPI"
        ],
        "summary": "Generates new payment preimage that is related to the given paymentHash and returns its hash..",
        "description": "Generates new reply payment preimage for the lightning network HODL invoice. Allows implementing payment chains. This preimage is secret as long as the gig-job referenced paymentHash is not marked as settled. The method returns hash of this preimage.",
        "operationId": "GenerateRelatedPreimage",
        "parameters": [
          {
            "name": "authToken",
            "in": "query",
            "description": "Authorisation token for the communication.",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "paymentHash",
            "in": "query",
            "description": "Payment hash of related HODL invoice.",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "/validaterelatedpaymenthashes": {
      "get": {
        "tags": [
          "GigGossipSettlerAPI"
        ],
        "summary": "Validates if given paymentHashes were generated by the same settler for the same gig.",
        "description": "Validates if given paymentHashes were generated by the same settler for the same gig. Allows implementing payment chains. The method returns true if the condition is met, false otherwise.",
        "operationId": "ValidateRelatedPaymentHashes",
        "parameters": [
          {
            "name": "authToken",
            "in": "query",
            "description": "Authorisation token for the communication.",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "paymentHash1",
            "in": "query",
            "description": "Payment hash of related HODL invoice.",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "paymentHash2",
            "in": "query",
            "description": "Payment hash of related HODL invoice.",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "boolean"
                }
              }
            }
          }
        }
      }
    },
    "/revealpreimage": {
      "get": {
        "tags": [
          "GigGossipSettlerAPI"
        ],
        "summary": "Reveals payment preimage of the specific paymentHash",
        "description": "Reveals payment preimage for the settlement of lightning network HODL invoice. This preimage is secret as long as the gig-job referenced paymentHash is not marked as settled.",
        "operationId": "RevealPreimage",
        "parameters": [
          {
            "name": "authToken",
            "in": "query",
            "description": "Authorisation token for the communication.",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "paymentHash",
            "in": "query",
            "description": "Payment hash of related HODL invoice.",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "/generatesettlementtrust": {
      "get": {
        "tags": [
          "GigGossipSettlerAPI"
        ],
        "summary": "Genertes Settlement Trust used by the gig-worker to estabilish trusted primise with the custmer.",
        "description": "Genertes Settlement Trust used by the gig-worker to estabilish trusted primise with the custmer.",
        "operationId": "GenerateSettlementTrust",
        "parameters": [
          {
            "name": "authToken",
            "in": "query",
            "description": "Authorisation token for the communication.",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "message",
            "in": "query",
            "description": "Message to be delivered to the customer.",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "replyinvoice",
            "in": "query",
            "description": "Invoice for the job.",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "signedRequestPayloadSerialized",
            "in": "query",
            "description": "Request payload",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "replierCertificateSerialized",
            "in": "query",
            "description": "Gig-worker certificate",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "/revealsymmetrickey": {
      "get": {
        "tags": [
          "GigGossipSettlerAPI"
        ],
        "summary": "Reveals symmetric key that customer can use to decrypt the message from gig-worker.",
        "description": "Reveals symmetric key that customer can use to decrypt the message from gig-worker. This key is secret as long as the gig-job is not marked as accepted.",
        "operationId": "RevealSymmetricKey",
        "parameters": [
          {
            "name": "authToken",
            "in": "query",
            "description": "Authorisation token for the communication.",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "gigId",
            "in": "query",
            "description": "Gig-job identifier.",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "repliperPubKey",
            "in": "query",
            "description": "Public key of the replier.",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "/managedispute": {
      "get": {
        "tags": [
          "GigGossipSettlerAPI"
        ],
        "summary": "Allows opening and closing disputes.",
        "description": "Allows opening and closing disputes. After opening, the dispute needs to be solved positively before the HODL invoice timeouts occure. Otherwise all the invoices and payments will be cancelled.",
        "operationId": "ManageDispute",
        "parameters": [
          {
            "name": "authToken",
            "in": "query",
            "description": "Authorisation token for the communication. This is a restricted call and authToken needs to be the token of the authorised user.",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "gigId",
            "in": "query",
            "description": "Gig-job identifier.",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "repliperPubKey",
            "in": "query",
            "description": "Public key of the replier.",
            "required": true,
            "style": "form",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "open",
            "in": "query",
            "description": "True to open/False to close dispute.",
            "required": true,
            "style": "form",
            "schema": {
              "type": "boolean"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    }
  },
  "components": { }
}